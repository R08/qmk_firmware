#include QMK_KEYBOARD_H
#include "../../../../../../../quantum/color.h"

// GUI + Shift Key
#define GS(KC) G(S(KC))

// Home Row Mods (GASC CSAG)
# define HR_A    KC_A //MT(MOD_LGUI, KC_A)
# define HR_S    KC_S //MT(MOD_LALT, KC_S)
# define HR_D    KC_D //MT(MOD_LSFT, KC_D)
# define HR_F    KC_F //MT(MOD_LCTL, KC_F)
# define HR_J    KC_J //MT(MOD_LCTL, KC_J)
# define HR_K    KC_K //MT(MOD_LSFT, KC_K)
# define HR_L    KC_L //MT(MOD_LALT, KC_L)
# define HR_SCLN KC_SCLN //MT(MOD_LGUI, KC_SCLN)

#define WRD_LEFT LCTL(KC_LEFT)
#define WRD_RIGHT LCTL(KC_RIGHT)


enum layers{
    L_BASE,
    L_LGUI,
    L_FN,
    L_CAPS,
    L_D,
    L_SPC
};

# define LT_CAPS LT(L_CAPS, KC_ESC)
/* # define LT_D LT(L_D, KC_D) */

# define GUI_LEFT LGUI(KC_LEFT)
# define GUI_RIGHT LGUI(KC_RIGHT)

# define LGSCL LGUI(LSFT(LCTL(KC_LEFT)))
# define LGSCR LGUI(LSFT(LCTL(KC_RIGHT)))

const HSV layer_colors[] = {
    [L_BASE] = { HSV_TEAL },
    [L_LGUI] ={ HSV_BLUE },
    [L_FN] ={ HSV_GOLDENROD },
    [L_CAPS] ={ HSV_TURQUOISE },
};

const int layer_colors_size = sizeof(layer_colors) / sizeof(layer_colors[0]);


const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {

[L_BASE] = LAYOUT_tkl_ansi(
//-|-----1-----|-----2-----|-----3----|-----4----|----5-----|----6-----|----7-----|----8-----|----9-----|----10----|----11----|---12-----|---13-----|---14-----|||---15-----|----16----|---17-----|
     KC_CAPS,     KC_F1,      KC_F2,     KC_F3,     KC_F4,     KC_F5,     KC_F6,     KC_F7,     KC_F8,     KC_F9,     KC_F10,    KC_F11,    KC_F12,                 KC_PSCR,   KC_CTANA,  RGB_MOD,
//-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------|
//-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------|
//-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------|
     KC_GRV,     KC_1,       KC_2,      KC_3,      KC_4,      KC_5,      KC_6,      KC_7,      KC_8,      KC_9,      KC_0,      KC_MINS,   KC_EQL,    KC_BSPC,     KC_INS,    KC_HOME,   KC_PGUP,
//-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------|
     KC_TAB,     KC_Q,       KC_W,      KC_E,      KC_R,      KC_T,      KC_Y,      KC_U,      KC_I,      KC_O,      KC_P,      KC_LBRC,   KC_RBRC,   KC_BSLS,     KC_DEL,    KC_END,    KC_PGDN,
//-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------|
     LT_CAPS,    HR_A,       HR_S,      HR_D,      HR_F,      KC_G,      KC_H,      HR_J,      HR_K,      HR_L,      HR_SCLN,   KC_QUOT,              KC_ENT,
//-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------|
     KC_LSFT,                KC_Z,      KC_X,      KC_C,      KC_V,      KC_B,      KC_N,      KC_M,      KC_COMM,   KC_DOT,    KC_SLSH,              KC_RSFT,                KC_UP,
//-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------|
     KC_LCTL,    MO(L_LGUI), KC_LALT,                                KC_SPC,                              KC_RALT,   KC_RGUI,   MO(L_FN),  KC_RCTL,     KC_LEFT,   KC_DOWN,   KC_RGHT
//-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------|
),


/* [L_D] = LAYOUT_tkl_ansi( */
/* //-|-----1-----|-----2-----|-----3----|-----4----|----5-----|----6-----|----7-----|----8-----|----9-----|----10----|----11----|---12-----|---13-----|---14-----|||---15-----|----16----|---17-----| */
/*      _______,     _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,                _______,   _______,   _______, */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/*      _______,     _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,     _______,   _______,   _______, */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/*      _______,     _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,     _______,   _______,   _______, */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/*      _______,     _______,   _______,   _______,   _______,   _______,   KC_BSPC,   _______,   _______,   KC_DEL,    _______,              _______,   _______, */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/*      _______,     _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,              _______,                           _______, */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/*      _______,     _______,   _______,                                _______,                                        _______,   _______,   _______,   _______,     _______,   _______,   _______ */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/* ), */
/**/
/**/
/* [L_SPC] = LAYOUT_tkl_ansi( */
/* //-|-----1-----|-----2-----|-----3----|-----4----|----5-----|----6-----|----7-----|----8-----|----9-----|----10----|----11----|---12-----|---13-----|---14-----|||---15-----|----16----|---17-----| */
/*      _______,     _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,                _______,   _______,   _______, */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/*      _______,     _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,     _______,   _______,   _______, */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/*      _______,     _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,     _______,   _______,   _______, */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/*      _______,     _______,   _______,   _______,   _______,   _______,   _______,   KC_ENT,    _______,   _______,   _______,              _______,   _______, */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/*      _______,     _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,              _______,                           _______, */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/*      _______,     _______,   _______,                                _______,                                        _______,   _______,   _______,   _______,     _______,   _______,   _______ */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/* ), */


[L_CAPS] = LAYOUT_tkl_ansi(
//-|-----1-----|-----2-----|-----3----|-----4----|----5-----|----6-----|----7-----|----8-----|----9-----|----10----|----11----|---12-----|---13-----|---14-----|||---15-----|----16----|---17-----|
     _______,     _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,                _______,   _______,   _______,
//-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------|
//-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------|
//-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------|
     _______,     _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,     _______,   _______,   _______,
//-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------|
     _______,     _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,     _______,   _______,   _______,
//-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------|
     _______,     _______,   _______,   _______,   _______,   _______,   G(KC_H),   G(KC_J),    G(KC_K),  G(KC_L),   KC_ENT,               _______,   _______,
//-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------|
     _______,     _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,              _______,                           _______,
//-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------|
     _______,     _______,   _______,                                KC_BSPC,                                        _______,   _______,   _______,   _______,     _______,   _______,   _______
//-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------|
),


[L_LGUI] = LAYOUT_tkl_ansi(
//-|-----1-----|-----2-----|-----3----|-----4----|----5-----|----6-----|----7-----|----8-----|----9-----|----10----|----11----|---12-----|---13-----|---14-----|||---15-----|----16----|---17-----|
     _______,    _______,   _______,  _______,  _______, _______,   _______,  _______,  _______,  _______,  _______,  _______,  _______,              _______,  _______,  _______,
//-|-----------|---------------------------------------------------------------------------------------------------------------------------------|||-----------------------------
//-|-----------|---------------------------------------------------------------------------------------------------------------------------------|||-----------------------------
     _______,    _______,   _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______,   _______, _______,  _______, _______,    _______,  _______, LGUI(KC_PGUP),
//-|-----------|---------------------------------------------------------------------------------------------------------------------------------|||-----------------------------
     _______,    _______,   _______,  _______,  _______,  _______,  _______,  KC_HOME,  WRD_LEFT, WRD_RIGHT, KC_END,  _______,  _______,  _______,    _______,  _______, LGUI(KC_PGDN),
//-|-----------|---------------------------------------------------------------------------------------------------------------------------------|||-----------------------------
     _______,    HR_A,      HR_S,     HR_D,     HR_F,     _______,  KC_LEFT,  KC_DOWN,  KC_UP,    KC_RIGHT,  _______, _______,            _______,
//-|---------------------------------------------------------------------------------------------------------------------------------------------|||-----------------------------
     _______,               KC_LCTL,  KC_LSFT,  _______,  _______,  KC_B,     _______,  _______,  _______,  _______,  _______,         _______,              LGUI(KC_UP),
//-|-----------|-----------|--------|----------------------------------------------------------------------|--------|---------|---------|--------|||-----------------------------
     _______,    _______,   _______,                                QK_LEAD,                                _______,  _______,  _______,  _______,  LGUI(KC_LEFT),  LGUI(KC_DOWN), LGUI(KC_RIGHT)
//-|-----------|-----------|--------|----------------------------------------------------------------------|--------|---------|---------|--------|||-----------------------------
),


[L_FN] = LAYOUT_tkl_ansi(
//-|-----1-----|-----2-----|-----3----|-----4----|----5-----|----6-----|----7-----|----8-----|----9-----|----10----|----11----|---12-----|---13-----|---14-----|||---15-----|----16----|---17-----|
     _______,  KC_BRID,  KC_BRIU,  KC_TASK,  KC_FILE,  RGB_VAD,  RGB_VAI,  KC_MPRV,  KC_MPLY,  KC_MNXT,  KC_MUTE,  KC_VOLD,  KC_VOLU,                DT_PRNT, DT_DOWN,  DT_UP,
//-|-----------|---------------------------------------------------------------------------------------------------------------------------------|||-----------------------------
//-|-----------|---------------------------------------------------------------------------------------------------------------------------------|||-----------------------------
     _______,  BT_HST1,  BT_HST2,  BT_HST3,  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______,      _______,  _______,  _______,
//-|-----------|---------------------------------------------------------------------------------------------------------------------------------|||-----------------------------
     RGB_TOG,  RGB_MOD,  RGB_VAI,  RGB_HUI,  RGB_SAI,  RGB_SPI,  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______,      _______,  _______,  _______,
//-|-----------|---------------------------------------------------------------------------------------------------------------------------------|||-----------------------------
     KC_CAPS,  RGB_RMOD, RGB_VAD,  RGB_HUD,  RGB_SAD,  RGB_SPD,  _______,  _______,  _______,  _______,  _______,  _______,            _______,
//-|-----------|---------------------------------------------------------------------------------------------------------------------------------|||-----------------------------
     _______,            _______,  _______,  _______,  _______,  BAT_LVL,  NK_TOGG,  _______,  _______,  _______,  _______,            _______,                _______,
//-|-----------|-----------|--------|----------------------------------------------------------------------|--------|---------|---------|--------|||-----------------------------
     _______,  _______,  _______,                                _______,                                _______,  _______,  _______,  _______,      _______,  _______,  _______
//-|-----------|-----------|--------|----------------------------------------------------------------------|--------|---------|---------|--------|||-----------------------------
)





/* //-|-----1-----|-----2-----|-----3----|-----4----|----5-----|----6-----|----7-----|----8-----|----9-----|----10----|----11----|---12-----|---13-----|---14-----|||---15-----|----16----|---17-----| */
/*      _______,     _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,                _______,   _______,   _______, */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/*      _______,     _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,     _______,   _______,   _______, */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/*      _______,     _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,     _______,   _______,   _______, */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/*      _______,     _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,              _______,   _______, */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/*      _______,     _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,              _______,                           _______, */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
/*      _______,     _______,   _______,                                _______,                                        _______,   _______,   _______,   _______,     _______,   _______,   _______ */
/* //-|-----------|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|||----------|----------|----------| */
};

/* Init function */
void keyboard_post_init_user(void) {
    rgb_matrix_mode_noeeprom(RGB_MATRIX_SOLID_COLOR);
    rgb_matrix_sethsv_noeeprom(RGB_TEAL);
}

/* Change LEDs based on layer */
layer_state_t layer_state_set_user(layer_state_t state) {
    int highest_layer = get_highest_layer(state);
    HSV color = {HSV_WHITE};

    if (highest_layer < layer_colors_size)
    {
        color = layer_colors[highest_layer];
    }

    rgblight_sethsv(color.h, color.s, color.v);

    return state;
}

//
// Leader keymaps
//
void leader_start_user(void) {
    // Do something when the leader key is pressed
}

void leader_end_user(void) {
    // Window navigation
    if (leader_sequence_two_keys(KC_W, KC_H)) {
        tap_code16(LGUI(KC_H));
    } if (leader_sequence_two_keys(KC_W, KC_J)) {
        tap_code16(LGUI(KC_J));
    } else if (leader_sequence_two_keys(KC_W, KC_K)) {
        tap_code16(LGUI(KC_K));
    } else if (leader_sequence_two_keys(KC_W, KC_L)) {
        tap_code16(LGUI(KC_L));
    } else if (leader_sequence_two_keys(KC_W, KC_J)) {
        tap_code16(LGUI(KC_J));

    } else if (leader_sequence_two_keys(KC_W, LSFT(KC_H))) {
        tap_code16(LGUI(LSFT(KC_J)));
    } else if (leader_sequence_two_keys(KC_W, LSFT(KC_J))) {
        tap_code16(LGUI(LSFT(KC_J)));
    } else if (leader_sequence_two_keys(KC_W, LSFT(KC_K))) {
        tap_code16(LGUI(LSFT(KC_K)));
    } else if (leader_sequence_two_keys(KC_W, LSFT(KC_L))) {
        tap_code16(LGUI(LSFT(KC_L)));
    }
}

//
// Per-key tapping term
//
uint16_t get_tapping_term(uint16_t keycode, keyrecord_t *record) {
    switch (keycode) {
        case QK_LEAD:
            return TAPPING_TERM + 1250;
        default:
            return TAPPING_TERM;
    }
}
